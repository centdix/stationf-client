{"remainingRequest":"/Users/farhad/Desktop/stationf/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/farhad/Desktop/stationf/client/src/components/SearchBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/farhad/Desktop/stationf/client/src/components/SearchBox.vue","mtime":1611167275987},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JzsKaW1wb3J0IFZ1ZVRpbWVwaWNrZXIgZnJvbSAndnVlMi10aW1lcGlja2VyJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2VhcmNoQm94JywKICBwcm9wczogWwogICAgJ3N0YXJ0X2RhdGUnLAogICAgJ2VuZF9kYXRlJywKICAgICdyb29tcycsCiAgICAnYm9va2luZ3MnLAogICAgJ2F2YWlsYWJsZV9yb29tcycKICBdLAogIGNvbXBvbmVudHM6IHsKICAgIFZ1ZVRpbWVwaWNrZXIsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0ZTogIiIsCiAgICAgIHRpbWU6ICIiLAogICAgICBkdXJhdGlvbjogIiIsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRTdGFydERhdGUoKSB7CiAgICAgIGxldCB0aW1lID0gdGhpcy50aW1lLnNwbGl0KCc6Jyk7CiAgICAgIGlmICh0aGlzLmRhdGUubGVuZ3RoID4gMCAmJiB0aW1lLmxlbmd0aCA+IDEpCiAgICAgICAgdGhpcy5zdGFydF9kYXRlID0gbmV3IG1vbWVudCh0aGlzLmRhdGUpLmhvdXJzKHRpbWVbMF0pLm1pbnV0ZXModGltZVsxXSk7CiAgICAgIHJldHVybiB0aGlzLnN0YXJ0X2RhdGU7CiAgICB9LAogICAgZ2V0RW5kRGF0ZSgpIHsKICAgICAgbGV0IGR1cmF0aW9uID0gdGhpcy5kdXJhdGlvbi5zcGxpdCgnOicpOwogICAgICB0aGlzLmVuZF9kYXRlID0gbnVsbDsKICAgICAgaWYgKHRoaXMuc3RhcnRfZGF0ZSAhPSBudWxsICYmIGR1cmF0aW9uLmxlbmd0aCA+IDEpIHsKICAgICAgICB0aGlzLmVuZF9kYXRlID0gdGhpcy5zdGFydF9kYXRlLmNsb25lKCk7CiAgICAgICAgdGhpcy5lbmRfZGF0ZS5hZGQocGFyc2VJbnQoZHVyYXRpb25bMF0sIDEwKSwgJ2hvdXJzJyk7CiAgICAgICAgdGhpcy5lbmRfZGF0ZS5hZGQocGFyc2VJbnQoZHVyYXRpb25bMV0sIDEwKSwgJ21pbnV0ZXMnKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5lbmRfdmFsdWU7CiAgICB9LAogICAgZmluZEJ5TmFtZShhcnIsIG5hbWUpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYXJyW2ldLm5hbWUgPT09IG5hbWUpCiAgICAgICAgICByZXR1cm4gaTsKICAgICAgfQogICAgICByZXR1cm4gLTE7CiAgICB9LAogICAgZGF0ZV9zZWFyY2goKSB7CiAgICAgIGxldCBzdGFydF92YWx1ZSA9IHRoaXMuZ2V0U3RhcnREYXRlKCk7CiAgICAgIGxldCBlbmRfdmFsdWUgPSB0aGlzLmdldEVuZERhdGUoKTsKICAgICAgaWYgKHN0YXJ0X3ZhbHVlID09PSBudWxsIHx8IGVuZF92YWx1ZSA9PT0gbnVsbCB8fCBzdGFydF92YWx1ZS5pc0JlZm9yZShuZXcgbW9tZW50KCkpKSB7CiAgICAgICAgdGhpcy4kdG9hc3RlZC5lcnJvcignSW52YWxpZCBvciBpbmNvbXBsZXRlIGlucHV0cycpLmdvQXdheSgxNTAwKTsKICAgICAgICByZXR1cm4gOwogICAgICB9CiAgICAgIGxldCBhdmFpbGFibGUgPSBbLi4udGhpcy5yb29tc107CiAgICAgIHRoaXMuYm9va2luZ3MuZm9yRWFjaCgoYikgPT4gewogICAgICAgIGxldCBzdGFydCA9IG1vbWVudChiLnN0YXJ0X2RhdGUpLnN1YnRyYWN0KDEsICdtaW51dGVzJyk7CiAgICAgICAgbGV0IGVuZCA9IG1vbWVudChiLmVuZF9kYXRlKS5hZGQoMSwgJ21pbnV0ZXMnKTsKICAgICAgICBpZiAoc3RhcnRfdmFsdWUuaXNCZXR3ZWVuKHN0YXJ0LCBlbmQpIHx8IGVuZF92YWx1ZS5pc0JldHdlZW4oc3RhcnQsIGVuZCkpCiAgICAgICAgewogICAgICAgICAgbGV0IGkgPSB0aGlzLmZpbmRCeU5hbWUoYXZhaWxhYmxlLCBiLnJvb21fbmFtZSk7CiAgICAgICAgICBhdmFpbGFibGUuc3BsaWNlKGksIDEpOwogICAgICAgIH0KICAgICAgfSkKICAgICAgdGhpcy5hdmFpbGFibGVfcm9vbXMgPSBhdmFpbGFibGU7IAogICAgfQogIH0KfQo="},{"version":3,"sources":["SearchBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SearchBox.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"date_search\">\n    <h3 class=\"text-center m-4\">Search by date and time</h3>\n    <div class=\"row mt-4 justify-content-center\">\n      <label class=\"col-3\">When: </label>\n      <input type=\"date\" id=\"date\" class=\"col-4\" v-model=\"date\">\n      <vue-timepicker :minute-interval=\"10\" v-model=\"time\" class=\"tp\"></vue-timepicker>\n    </div>\n    <div class=\"row mt-4 justify-content-center\">\n      <label class=\"col-3\">Duration: </label>\n      <vue-timepicker\n        :hour-range=\"[0, 1, 2, 3, 4, 5]\"\n        :minute-interval=\"30\"\n        v-model=\"duration\"\n        class=\"tp\">    \n      </vue-timepicker>\n      <button @click=\"date_search\" class=\"btn-secondary col-2 offset-md-2\">Search</button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import moment from 'moment';\n  import VueTimepicker from 'vue2-timepicker';\n\n  export default {\n    name: 'SearchBox',\n    props: [\n      'start_date',\n      'end_date',\n      'rooms',\n      'bookings',\n      'available_rooms'\n    ],\n    components: {\n      VueTimepicker,\n    },\n    data() {\n      return {\n        date: \"\",\n        time: \"\",\n        duration: \"\",\n      }\n    },\n    methods: {\n      getStartDate() {\n        let time = this.time.split(':');\n        if (this.date.length > 0 && time.length > 1)\n          this.start_date = new moment(this.date).hours(time[0]).minutes(time[1]);\n        return this.start_date;\n      },\n      getEndDate() {\n        let duration = this.duration.split(':');\n        this.end_date = null;\n        if (this.start_date != null && duration.length > 1) {\n          this.end_date = this.start_date.clone();\n          this.end_date.add(parseInt(duration[0], 10), 'hours');\n          this.end_date.add(parseInt(duration[1], 10), 'minutes');\n        }\n        return this.end_value;\n      },\n      findByName(arr, name) {\n        for (let i = 0; i < arr.length; i++) {\n          if (arr[i].name === name)\n            return i;\n        }\n        return -1;\n      },\n      date_search() {\n        let start_value = this.getStartDate();\n        let end_value = this.getEndDate();\n        if (start_value === null || end_value === null || start_value.isBefore(new moment())) {\n          this.$toasted.error('Invalid or incomplete inputs').goAway(1500);\n          return ;\n        }\n        let available = [...this.rooms];\n        this.bookings.forEach((b) => {\n          let start = moment(b.start_date).subtract(1, 'minutes');\n          let end = moment(b.end_date).add(1, 'minutes');\n          if (start_value.isBetween(start, end) || end_value.isBetween(start, end))\n          {\n            let i = this.findByName(available, b.room_name);\n            available.splice(i, 1);\n          }\n        })\n        this.available_rooms = available; \n      }\n    }\n  }\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style>\n  .tp {\n    flex: 0 0 25%;\n    max-width: 100%;\n  }\n</style>\n"]}]}