{"remainingRequest":"/Users/farhad/Desktop/stationf/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/farhad/Desktop/stationf/client/src/App.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/farhad/Desktop/stationf/client/src/App.vue","mtime":1611142222506},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/farhad/Desktop/stationf/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI2FwcCB7CiAgZm9udC1mYW1pbHk6IEF2ZW5pciwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsKICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsKICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOwogIGNvbG9yOiAjMmMzZTUwOwogIG1hcmdpbi10b3A6IDMwcHg7Cn0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0IA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\" class=\"container\">\n    <h1 class=\"text-center\">Book a meeting room</h1>\n    <div id=\"date_search\">\n      <h3 class=\"text-center m-4\">Search by date and time</h3>\n      <div class=\"row mt-4 justify-content-center\">\n        <label class=\"col-3\">When: </label>\n        <input type=\"date\" id=\"date\" class=\"col-4\">\n        <input type=\"time\" id=\"time\" class=\"col-3\">\n      </div>\n      <div class=\"row mt-4 justify-content-center\">\n        <label class=\"col-3\">Duration: </label>\n        <input type=\"time\" id=\"duration\" class=\"col-3\">\n        <button @click=\"date_search\" class=\"btn-secondary col-2 offset-md-2\">Search</button>\n      </div>\n      <div id=\"results\" class=\"mt-5 ml-1\" v-if=\"available_rooms.length > 0\">\n        <h5>Rooms available from {{ getStartDate() }} to {{ getEndDate() }} :</h5>\n        <div class=\"card mt-3\" v-for=\"ar in available_rooms\" :key=\"ar.id\">\n          <h5 class=\"card-header text-center\">\n            {{ ar.name }}\n          </h5>\n          <div class=\"card-body\">\n            <div class=\"row m-2 justify-content-center\">\n              <div class=\"col-4\">\n                Capacity: {{ ar.capacity }}\n              </div>\n              <div class=\"col-4\">\n                Equipements: <br>\n                <span v-for=\"e in ar.equipements\" :key=\"e.id\" class=\"ml-3\">\n                  {{ e.name }}\n                </span>\n              </div>\n            </div>\n            <div class=\"row justify-content-end m-3\">\n              <button class=\"btn btn-primary col-3\" @click=\"book(ar)\">Book</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <hr>\n    <ul>\n      <li v-for=\"booking in bookings\" :key=\"booking.id\">\n        {{ booking.room_name }} : {{ booking.start_date | moment(\"dddd, MMMM Do YY, h:mm:ss a\") }} - {{ booking.end_date | moment(\"dddd, MMMM Do YY, h:mm:ss a\") }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\n  import moment from 'moment';\n\n  export default {\n    name: 'App',\n    data() {\n      return {\n        available_rooms: [],\n        rooms: [],\n        bookings: [],\n      }\n    },\n    async mounted() {\n      let url = 'http://localhost:8000/';\n      let response = await fetch(url + 'rooms', { method: 'get' });\n      let data = await response.json();\n      this.rooms = data.rooms;\n      response = await fetch(url + 'bookings', { method: 'get' })\n      data = await response.json();\n      this.bookings = data.bookings;\n    },\n    methods: {\n      async book(room) {\n        let date = document.getElementById('date').value;\n        let time = document.getElementById('time').value.split(':');\n        let duration = document.getElementById('duration').value.split(':');\n        let start_date = new moment(date).hours(time[0]).minutes(time[1]);\n        let end_date = start_date.clone();\n        end_date.add(parseInt(duration[0], 10), 'hours');\n        end_date.add(parseInt(duration[1], 10), 'minutes');\n        let booking = {\n          room_name: room.name,\n          start_date: start_date,\n          end_date: end_date,\n        };\n        let res = await fetch('http://localhost:8000/book', {\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          method: 'POST',\n          body: JSON.stringify(booking),\n        });\n        let response = await res.json();\n        this.bookings = response.bookings;\n      },\n      getStartDate() {\n        let date = document.getElementById('date').value;\n        let time = document.getElementById('time').value.split(':');\n        let start_value = new moment(date).hours(time[0]).minutes(time[1]);\n        return start_value;\n      },\n      getEndDate() {\n        let duration = document.getElementById('duration').value.split(':');\n        let start_value = this.getStartDate();\n        let end_value = start_value.clone();\n        end_value.add(parseInt(duration[0], 10), 'hours');\n        end_value.add(parseInt(duration[1], 10), 'minutes');\n        return end_value;\n      },\n      findByName(arr, name) {\n        for (let i = 0; i < arr.length; i++) {\n          if (arr[i].name === name)\n            return i;\n        }\n        return -1;\n      },\n      date_search() {\n        if (date.length > 0 && time.length > 1 && duration.length > 1) {\n          let start_value = this.getStartDate();\n          let end_value = this.getEndDate();\n          let available = [...this.rooms];\n          this.bookings.forEach((b) => {\n            let start = moment(b.start_date).subtract(1, 'minutes');\n            let end = moment(b.end_date).add(1, 'minutes');\n            if (start_value.isBetween(start, end) || end_value.isBetween(start, end))\n            {\n              let i = this.findByName(available, b.room_name);\n              available.splice(i, 1);\n            }\n          })\n          this.available_rooms = available;\n        }\n\n      }\n    }\n  }\n</script>\n\n<style>\n  #app {\n    font-family: Avenir, Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    color: #2c3e50;\n    margin-top: 30px;\n  }\n</style>\n"]}]}